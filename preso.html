

<!DOCTYPE html>
<html>
  <head>
    <title>The power of Go</title>
    <meta charset='utf-8'>
    <script src='/static/slides.js'></script>
  </head>

  <body style='display: none'>

    <section class='slides layout-widescreen'>
      
      <article>
        <h1>The power of Go</h1>
        <h3>7 April 2015</h3>
        
        
          <div class="presenter">
            
  
  <p>
    Marc Grol
  </p>
  

  
  <p>
    Software engineer, Xebia
  </p>
  

          </div>
        
          <div class="presenter">
            
  
  <p>
    
  </p>
  

          </div>
        
      </article>
      
  
  
      <article>
      
        <h3>About me</h3>
        
<div class="image">
  <img src="images/marc.jpg">
</div>

  <ul>
  
    <li>Running, cycling</li>
  
  </ul>

  <ul>
  
    <li>Telecom, Finance, Mobile</li>
  
    <li>C, C++, Java, Unix, DSL&#39;s, DDD, Go</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Approach</h3>
        
  <ul>
  
    <li>Learn by example</li>
  
    <li>See code, run code</li>
  
    <li>Associate with something you already know</li>
  
    <li>Please interrupt for questions</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Your experience?</h3>
        
  <ul>
  
    <li>Go installed on laptop?</li>
  
    <li>Written any code?</li>
  
    <li>Did tour, tutorial? Read a book?</li>
  
    <li>Used go tool-chain? go get, go install?</li>
  
    <li>Build http-client and http-server?</li>
  
    <li>json/xml marshalling?</li>
  
    <li>Used channels en goroutines?</li>
  
    <li>Unit testing?</li>
  
    <li>Own open-source project?</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Why go was created?</h3>
        
  <ul>
  
    <li>Help Google solve problems</li>
  
    <li>Simple</li>
  
    <li>Scale: infrastructure, teams, code bases</li>
  
    <li>Compile and run fast</li>
  
    <li>Safe and reliable</li>
  
    <li>Optimum between C++ and Python</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Setup environment</h3>
        
  <ul>
  
    <li>Install</li>
  
  </ul>
<p class="link"><a href="https://golang.org/doc/install#download" target="_blank">golang.org/doc/install#download</a></p>
  <ul>
  
    <li>Verify installation</li>
  
  </ul>

  
  <div class="code"><pre>$ which go # typically located in /usr/local/go/bin/go
$ go env</pre></div>
  

  <ul>
  
    <li>Post installation steps</li>
  
  </ul>

  
  <div class="code"><pre># Set GOROOT in your shell startup (~/.bash_profile)
$ export GOROOT=/usr/local/go

# Add go to your PATH (in ~/.bash_profile)
$ PATH=${PATH}:${GOROOT}/bin</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Workspace GOPATH</h3>
        
  <ul>
  
    <li>Directory ${GOPATH} contains all your personal go stuff</li>
  
    <li>Convention:</li>
  
  </ul>

  
  <div class="code"><pre>${GOPATH}
├── src/   # source code
├── pkg/   # intermedia libraries objects
└── bin/   # executables</pre></div>
  

  <ul>
  
    <li>The tooling knows how to build</li>
  
  </ul>

  <ul>
  
    <li>Post installation steps</li>
  
  </ul>

  
  <div class="code"><pre># Set ${GOPATH}/bin in your shell startup (~/.bash_profile)
$ export GOPATH=~/src/go
# add GOPATH to your PATH (~/.bash_profile)
$ export PATH=${PATH}:${GOPATH}/bin</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>First program</h3>
        
  
  <div class="code"><pre>$ mkdir -p ${GOPATH}/src/github.com/&lt;your-github-username&gt;/hello
$ cd ${GOPATH}/src/github.com/MarcGrol/hello</pre></div>
  

  <ul>
  
    <li>Source code: first.go</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">


<pre><span num="1">package main</span>
<span num="2"></span>
<span num="3">import (</span>
<span num="4">    &#34;fmt&#34;</span>
<span num="5">)</span>
<span num="6"></span>
<span num="7">func main() {</span>
<span num="8">    fmt.Printf(&#34;Hi %s\n&#34;, &#34;everybody&#34;)</span>
<span num="9">}</span>
</pre>


</div>

  
  <div class="code"><pre>$ go run first.go or
$ go install # creates executable &#34;hello&#34; in ${GOPATH}/bin
$ hello
Hi everybody!</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Summary of language</h3>
        
  <ul>
  
    <li>Keywords: </li>
  
  </ul>

  
  <div class="code"><pre>break case continue default defer else fallthrough for goto if return switch
package import func const interface map range struct type chan go select var</pre></div>
  

  <ul>
  
    <li>Types:</li>
  
  </ul>

  
  <div class="code"><pre>bool byte complex64 complex128 error float32 float64
int int8 int16 int32 int64 rune string
uint uint8 uint16 uint32 uint64 uintptr</pre></div>
  

  <ul>
  
    <li>Constants:</li>
  
  </ul>

  
  <div class="code"><pre>true false iota</pre></div>
  

  <ul>
  
    <li>Zero value:</li>
  
  </ul>

  
  <div class="code"><pre>nil</pre></div>
  

  <ul>
  
    <li>Functions:</li>
  
  </ul>

  
  <div class="code"><pre>append cap close complex copy delete len make new panic recover</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Packages</h3>
        
  <ul>
  
    <li>Each package in dedicated directory</li>
  
  </ul>

  <ul>
  
    <li>Standard packages shipped with go in ${GOROOT}</li>
  
  </ul>

  
  <div class="code"><pre>source in ${GOROOT}/src/...
compiled in ${GOROOT}/pkg/...
example: log, strings, io, errors, time, fmt, http, ....</pre></div>
  

  <ul>
  
    <li>Your own or third-party packages in ${GOPATH}</li>
  
  </ul>

  
  <div class="code"><pre>source-code in ${GOPATH}/src/...
compiled in ${GOPATH}/pkg/...
example: ${GOPATH}/src/github.com/gin-gonic/gin</pre></div>
  

  <ul>
  
    <li>Package name first line of source file</li>
  
  </ul>

  
  <div class="code"><pre>package main // package that results in executable
package news // package that results in library &#34;news.a&#34;</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Imports</h3>
        
  <ul>
  
    <li>Use fully qualified name</li>
  
    <li>Last part short and sweet: fmt, http, log, ..</li>
  
  </ul>

  <div class="code" contenteditable="true" spellcheck="false">


<pre contenteditable="true" spellcheck="false"><span num="1">package packaging</span>
<span num="2"></span>
<span num="3">import (</span>
<span num="4">    &#34;fmt&#34;</span>
<span num="5">    &#34;github.com/gin-gonic/gin&#34;</span>
<span num="6">    &#34;net/http&#34;</span>
<span num="7">)</span>
<span num="8"></span>
<span num="9">func ListenForWebRequests() {</span>
<span num="10">    <b>engine := gin.Default()</b></span>
<span num="11"></span>
<span num="12">    engine.GET(&#34;/hello&#34;, func(c *gin.Context) {</span>
<span num="13">        <b>c.String(http.StatusOK, fmt.Sprintf(&#34;Message from planet %s&#34;, &#34;Mars&#34;))</b></span>
<span num="14">    })</span>
<span num="15"></span>
<span num="16">    // will block</span>
<span num="17">    engine.Run(&#34;:8080&#34;)</span>
<span num="18">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Variables</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import (
  &#34;fmt&#34;
)

</span></pre>

<pre><span num="8">const myConstString = &#34;golang&#34;</span>
<span num="9"></span>
<span num="10">func main() {</span>
<span num="11">    var status bool // uninitialized</span>
<span num="12">    var idx int64 = 42</span>
<span num="13">    <b>// := short notation: derives type from right-hand-side</b></span>
<span num="14">    <b>i := 256</b></span>
<span num="15">    longString := `{</span>
<span num="16">        &#34;why&#34;:&#34;Usefull to embed json in source&#34;</span>
<span num="17">    }`</span>
<span num="18">    myList := []int{1, 3, 5, 7}</span>
<span num="19">    fmt.Printf(</span>
<span num="20">        &#34;status:%v\nidx:%d\ni=%d\nmy-const-string:%s\nmy-long-string:%s\nmy-list:%&#43;v\n&#34;,</span>
<span num="21">        status, idx, i, myConstString, longString, myList)</span>
<span num="22">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Loops</h3>
        
  <ul>
  
    <li>for</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

</span></pre>

<pre><span num="6">func main() {</span>
<span num="7">    sum := 0</span>
<span num="8">    for i := 0; i &lt; 10; i&#43;&#43; {</span>
<span num="9">        sum &#43;= i</span>
<span num="10">    }</span>
<span num="11">    fmt.Println(sum)</span>
<span num="12">}</span>
</pre>


</div>

  <ul>
  
    <li>while-like</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

</span></pre>

<pre><span num="6">func main() {</span>
<span num="7">    sum := 1</span>
<span num="8">    // while like</span>
<span num="9">    for sum &lt; 1000 {</span>
<span num="10">        sum &#43;= sum</span>
<span num="11">    }</span>
<span num="12">    fmt.Println(sum)</span>
<span num="13">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>If, else</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">


<pre><span num="1">package main</span>
<span num="2"></span>
<span num="3">import (</span>
<span num="4">    &#34;fmt&#34;</span>
<span num="5">)</span>
<span num="6"></span>
<span num="7">func main() {</span>
<span num="8">    num := 9</span>
<span num="9">    if num &lt; 0 {</span>
<span num="10">        fmt.Println(num, &#34;is negative&#34;)</span>
<span num="11">    } else if num &lt; 10 {</span>
<span num="12">        fmt.Println(num, &#34;has 1 digit&#34;)</span>
<span num="13">    } else {</span>
<span num="14">        fmt.Println(num, &#34;has multiple digits&#34;)</span>
<span num="15">    }</span>
<span num="16">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Switch</h3>
        
  <ul>
  
    <li>On any type</li>
  
    <li>No fallthrough unless explicitly stated</li>
  
    <li>Multiple cases</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

</span></pre>

<pre><span num="6">func unhex(c byte) byte {</span>
<span num="7">    switch {</span>
<span num="8">    case &#39;0&#39; &lt;= c &amp;&amp; c &lt;= &#39;9&#39;:</span>
<span num="9">        return c - &#39;0&#39;</span>
<span num="10">    case &#39;a&#39; &lt;= c &amp;&amp; c &lt;= &#39;f&#39;:</span>
<span num="11">        return c - &#39;a&#39; &#43; 10</span>
<span num="12">    case &#39;A&#39; &lt;= c &amp;&amp; c &lt;= &#39;F&#39;:</span>
<span num="13">        return c - &#39;A&#39; &#43; 10</span>
<span num="14">    }</span>
<span num="15">    return 0</span>
<span num="16">}</span>
<span num="17"></span>
<span num="18">func main() {</span>
<span num="19">    fmt.Printf(&#34;1 -&gt; %d\n&#34;, unhex(&#39;1&#39;))</span>
<span num="20">    fmt.Printf(&#34;9 -&gt; %d\n&#34;, unhex(&#39;9&#39;))</span>
<span num="21">    fmt.Printf(&#34;A -&gt; %d\n&#34;, unhex(&#39;A&#39;))</span>
<span num="22">    fmt.Printf(&#34;F -&gt; %d\n&#34;, unhex(&#39;F&#39;))</span>
<span num="23">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Functions</h3>
        
  <ul>
  
    <li>Core building block</li>
  
  </ul>

  <ul>
  
    <li>Scope: based on case</li>
  
  </ul>

  <div class="code" contenteditable="true" spellcheck="false">


<pre><span num="1">package functions</span>
<span num="2"></span>
<span num="3">import &#34;fmt&#34;</span>
<span num="4"></span>
<span num="5">// START OMIT </span>
<span num="6"><b>func ConvertIt( arg int ) string {</b></span>
<span num="7">    return convertInternal( arg )</span>
<span num="8">}</span>
<span num="9">func convertInternal( arg int ) string { // internal, unexported function</span>
<span num="10">    return fmt.Sprintf( &#34;My integer value as string: %d&#34;, arg)</span>
<span num="11">}</span>
</pre>


</div>

  <ul>
  
    <li>Can return multiple values</li>
  
  </ul>

  
  <div class="code"><pre>func swap(x, y string) (string, string) { 
   return y, x 
}</pre></div>
  

  <ul>
  
    <li>Package initialisation</li>
  
  </ul>

  
  <div class="code"><pre>func init() {
  // your global initialisations here
}</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Variadic functions</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">


<pre><span num="1">package main</span>
<span num="2"></span>
<span num="3">import &#34;fmt&#34;</span>
<span num="4"></span>
<span num="6">func sum(nums ...int) {</span>
<span num="7">    fmt.Print(nums, &#34; &#34;)</span>
<span num="8">    total := 0</span>
<span num="9">    for _, num := range nums {</span>
<span num="10">        total &#43;= num</span>
<span num="11">    }</span>
<span num="12">    fmt.Println(total)</span>
<span num="13">}</span>
<span num="14"></span>
<span num="15">func main() {</span>
<span num="16"></span>
<span num="17">    sum(1, 2)</span>
<span num="18">    sum(1, 2, 3)</span>
<span num="19"></span>
<span num="20">    nums := []int{1, 2, 3, 4}</span>
<span num="21">    sum(nums...)</span>
<span num="22">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Functions as parameters</h3>
        
  <ul>
  
    <li>Closures: anonymous functions</li>
  
    <li>Can reference variables from outside its function body.</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

</span></pre>

<pre><span num="6">func intSeq() func() int {</span>
<span num="7">    i := 0</span>
<span num="8">    <b>return func() int {</b></span>
<span num="9">        <b>i &#43;= 1</b></span>
<span num="10">        <b>return i</b></span>
<span num="11">    <b>}</b></span>
<span num="12">}</span>
<span num="13"></span>
<span num="14">func main() {</span>
<span num="15">    nextInt := intSeq()</span>
<span num="16"></span>
<span num="17">    // See the effect of the closure by calling nextInt a few times.</span>
<span num="18">    fmt.Println(nextInt())</span>
<span num="19">    fmt.Println(nextInt())</span>
<span num="20">    fmt.Println(nextInt())</span>
<span num="21"></span>
<span num="22">    // To confirm that the state is unique to that particular function</span>
<span num="23">    newInts := intSeq()</span>
<span num="24">    fmt.Println(newInts())</span>
<span num="25">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Defer</h3>
        
  <ul>
  
    <li>Useful for cleanup: file-handles, mutexes</li>
  
    <li>Useful for debugging: log &#34;enter&#34; and &#34;leave&#34; of function</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">


<pre><span num="1">package main</span>
<span num="2"></span>
<span num="3">import &#34;fmt&#34;</span>
<span num="4"></span>
<span num="5">func main() {</span>
<span num="6">    defer fmt.Println(&#34;world&#34;)</span>
<span num="7"></span>
<span num="8">    fmt.Println(&#34;hello&#34;)</span>
<span num="9">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Struct and methods</h3>
        
  <ul>
  
    <li>Compare Java class with methods</li>
  
    <li>Use pointer * when modifying struct</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

var me Person = Person{
  Name:      &#34;Marc Grol&#34;,
  Interests: []string{&#34;Running&#34;, &#34;Golang&#34;},
  Children: []Child{
    {Name: &#34;Pien&#34;, Age: 12},
    {Name: &#34;Tijl&#34;, Age: 9},
  },
}

</span></pre>

<pre><span num="15">type Person struct {</span>
<span num="16">    Name      string</span>
<span num="17">    Interests []string</span>
<span num="18">    Children  []Child</span>
<span num="19">}</span>
<span num="20"></span>
<span num="21">type Child struct {</span>
<span num="22">    Name string</span>
<span num="23">    Age  int</span>
<span num="24">}</span>
<span num="25"></span>
<span num="26"><b>func (p *Person) AddChild(child Child) {</b></span>
<span num="27">    p.Children = append(p.Children, child)</span>
<span num="28">}</span>
<span num="29"></span>
<span num="30">func main() {</span>
<span num="31">    // me := Person{...}</span>
<span num="32">    me.AddChild(Child{Name: &#34;Freek&#34;, Age: 5})</span>
<span num="33">    fmt.Printf(&#34;%&#43;v\n&#34;, me)</span>
<span num="34">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Pointers</h3>
        
  <ul>
  
    <li>Pass &#34;by value&#34; is default</li>
  
    <li>Use &#34;pointers&#34; to pass &#34;by reference&#34;</li>
  
    <li>Useful for passing large objects around</li>
  
  </ul>

  
  <div class="code"><pre>var personP *Person = new(Person)
personP.Name = &#34;Boogerd&#34;
storePerson( personP )

or

person := Person{Name:&#34;Boogerd&#34;}
storePerson( &amp;person )</pre></div>
  

  <ul>
  
    <li>Note: Slices, maps and channels are already refs</li>
  
    <li>Note: Pass by value has no side effects</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Object construction</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>// hello.go
package main

import (
  &#34;fmt&#34;
)

type Person struct {
  Name      string
  Interests []string
  Children  []Child
}

type Child struct {
  Name string
  Age  int
}

</span></pre>

<pre><span num="20">func NewPerson(name string, interests ...string) *Person {</span>
<span num="21">    <b>person := new(Person)</b></span>
<span num="22">    person.Name = name</span>
<span num="23">    <b>person.Interests = make([]string, 0, len(interests))</b></span>
<span num="24">    for _, interest := range interests {</span>
<span num="25">        person.Interests = append(person.Interests, interest)</span>
<span num="26">    }</span>
<span num="27">    <b>person.Children = make([]Child, 0, 10)</b></span>
<span num="28">    return person</span>
<span num="29">}</span>
<span num="30"></span>
<span num="31">func main() {</span>
<span num="32">    me := Person{</span>
<span num="33">        Name:      &#34;Marc Grol&#34;,</span>
<span num="34">        Interests: []string{&#34;Running&#34;, &#34;Golang&#34;},</span>
<span num="35">        Children: []Child{</span>
<span num="36">            {Name: &#34;Pien&#34;, Age: 12},</span>
<span num="37">            {Name: &#34;Tijl&#34;, Age: 9},</span>
<span num="38">            {Name: &#34;Freek&#34;, Age: 5},</span>
<span num="39">        },</span>
<span num="40">    }</span>
<span num="41">    you := NewPerson(&#34;Eva Berkhout&#34;, &#34;Running&#34;, &#34;Reading&#34;)</span>
<span num="42">    fmt.Printf(&#34;me:%&#43;v\nyou:%&#43;v&#34;, me, you)</span>
<span num="43">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Enum</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import (
  &#34;fmt&#34;
)

</span></pre>

<pre><span num="8">type Color int</span>
<span num="9"></span>
<span num="10">const (</span>
<span num="11">    Red   Color = iota // 0 (=default)</span>
<span num="12">    Green              // 1</span>
<span num="13">    Blue               // 2</span>
<span num="14">)</span>
<span num="15"></span>
<span num="16">func (c Color) String() string {</span>
<span num="17">    switch c {</span>
<span num="18">    case Red:</span>
<span num="19">        return &#34;red&#34;</span>
<span num="20">    case Green:</span>
<span num="21">        return &#34;green&#34;</span>
<span num="22">    case Blue:</span>
<span num="23">        return &#34;blue&#34;</span>
<span num="24">    default:</span>
<span num="25">        return &#34;unknown&#34;</span>
<span num="26">    }</span>
<span num="27">}</span>
<span num="28">func main() {</span>
<span num="29">    myColor := Green</span>
<span num="30">    fmt.Printf(&#34;my-color: %d - %s\n&#34;, myColor, myColor.String())</span>
<span num="31">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Containers</h3>
        
  <ul>
  
    <li>array</li>
  
    <li>slice</li>
  
    <li>map</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Array</h3>
        
  <ul>
  
    <li>Fixed length immutable</li>
  
  </ul>

  
  <div class="code"><pre>numbers := [4]int{10, 20, 30, 40}

fmt.Printf( &#34;second value: %d&#34;, numbers[1] ) 

// idiomatic: let compiler count
s := [...]string{&#34;Penn&#34;, &#34;Teller&#34;}</pre></div>
  

  <ul>
  
    <li>Iterate over array</li>
  
  </ul>

  
  <div class="code"><pre>for idx := 0 ; idx&lt;4; idx&#43;&#43; {
   fmt.Printf(&#34;%d:%d\n&#34;, idx, numbers[idx])
}</pre></div>
  

  <ul>
  
    <li>Typical:   </li>
  
  </ul>

  
  <div class="code"><pre>for index, value := range numbers {
   fmt.Printf(&#34;%d:%d\n&#34;, index, value)
}</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Slice</h3>
        
  <ul>
  
    <li>Dynamic array: can grow in size</li>
  
  </ul>

  
  <div class="code"><pre>letters := []string{&#34;a&#34;, &#34;b&#34;, &#34;c&#34;, &#34;d&#34;}
subslice = letters[2:3] // c and d
or
slice := make( []string, 0, 5 )
slice = append( slice, &#34;first entry&#34; )
fmt.Printf( &#34;slice-length: %d slice-capacity: %d slice-values:%&#43;v&#34;,  
                len(slice),
                cap(slice),
                slice)</pre></div>
  

  <ul>
  
    <li>Iterate over slice</li>
  
  </ul>

  
  <div class="code"><pre>for _, value := range numbers {
   fmt.Printf(&#34;%d\n&#34;, value)
}</pre></div>
  

  <ul>
  
    <li>Sorting: use sort package</li>
  
  </ul>

  <ul>
  
    <li>Generics: use &#34;gen&#34; code-generator (github.com/clipperhouse/gen)</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Map</h3>
        
  <ul>
  
    <li>Store key-value pairs</li>
  
  </ul>

  
  <div class="code"><pre>m = make(map[string]int)
m[&#34;route&#34;] = 66
delete(m, &#34;route&#34;)
i, ok := m[&#34;route&#34;]</pre></div>
  

  <ul>
  
    <li>Iterate over map</li>
  
  </ul>

  
  <div class="code"><pre>for key, value := range numbers {
   fmt.Printf(&#34;%s - %d&#34;,key, value)
}</pre></div>
  

  <ul>
  
    <li>Random iteration order</li>
  
    <li>Not thread safe (combine with Mutex)</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Error handling</h3>
        
  <ul>
  
    <li>Multiple return values</li>
  
    <li>if error is nil, the call worked</li>
  
  </ul>

  
  <div class="code"><pre>resp, err := doSomethingThatCanFail(arg1, arg2)
if err != nil {
    // log?
    return err
}
// continue with success path

// use _ (=blank) if you don&#39;t care
resp, _ := doit(arg1, arg2)</pre></div>
  

  <ul>
  
    <li>Function signature tells that things can go wrong</li>
  
  </ul>

  <ul>
  
    <li>You own API&#39;s should use this pattern</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Interfaces</h3>
        
  <ul>
  
    <li>UNIX filosophy: small, sharp tool combined to solve larger tasks</li>
  
    <li>go packages interact via small interfaces, no large hierarchies.</li>
  
  </ul>

  <ul>
  
    <li>example: I/O</li>
  
  </ul>

  
  <div class="code"><pre>func Fprintf(w io.Writer, format string, a ...interface{}) (n int, err error)

type Writer interface {
    Write(p []byte) (n int, err error)
}
&#34;Writer&#34; can be file, buffer, stdout, network, http-response, zip-file etc</pre></div>
  

  <ul>
  
    <li>example: built-in interface &#34;error&#34;</li>
  
  </ul>

  
  <div class="code"><pre>type error interface {
    Error() string
}</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Interface example</h3>
        
  <ul>
  
    <li>Just implement the methods and voila</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">


<pre><span num="1">package main</span>
<span num="2"></span>
<span num="3">import &#34;fmt&#34;</span>
<span num="4"></span>
<span num="5">type Person struct {</span>
<span num="6">    Name string</span>
<span num="7">    Age  int</span>
<span num="8">}</span>
<span num="9"></span>
<span num="10">// type Stringer interface {</span>
<span num="11">//    String() string</span>
<span num="12">// }</span>
<span num="13">func (p Person) String() string {</span>
<span num="14">    return fmt.Sprintf(&#34;%v (%v years)&#34;, p.Name, p.Age)</span>
<span num="15">}</span>
<span num="16"></span>
<span num="17">func main() {</span>
<span num="18">    a := Person{&#34;Arthur Dent&#34;, 42}</span>
<span num="19">    z := Person{&#34;Zaphod Beeblebrox&#34;, 9001}</span>
<span num="20">    fmt.Println(a, z)</span>
<span num="21">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Concurrency</h3>
        
  
  <p>
    Most code is synchronous
<br>

    Concurrent-style not forced upon you, used selectively
  </p>
  

  <ul>
  
    <li>built-in &#34;channels&#34; and &#34;goroutines&#34;</li>
  
    <li>Goroutines: think very, very lightweight threads</li>
  
    <li>Channels: think pipe or queue to communicate with coroutine</li>
  
    <li>&#34;select&#34;-loop in heart of program</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Concurrency example</h3>
        
  <ul>
  
    <li>Share Memory By Communicating</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import &#34;fmt&#34;

</span></pre>

<pre><span num="6">func sum(a []int, c chan int) {</span>
<span num="7">    sum := 0</span>
<span num="8">    for _, v := range a {</span>
<span num="9">        sum &#43;= v</span>
<span num="10">    }</span>
<span num="11">    c &lt;- sum // send sum to c</span>
<span num="12">}</span>
<span num="13"></span>
<span num="14">func main() {</span>
<span num="15">    a := []int{7, 2, 8, -9, 4, 0}</span>
<span num="16"></span>
<span num="17">    c := make(chan int)</span>
<span num="18">    go sum(a[:len(a)/2], c)</span>
<span num="19">    go sum(a[len(a)/2:], c)</span>
<span num="20">    x, y := &lt;-c, &lt;-c // receive from c</span>
<span num="21"></span>
<span num="22">    fmt.Println(x, y, x&#43;y)</span>
<span num="23">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Select example</h3>
        
  <ul>
  
    <li>Waitfor events on multiple channels</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import (
  &#34;fmt&#34;
  &#34;time&#34;
)

</span></pre>

<pre><span num="9"><b>func sendMsg(c chan string) {</b></span>
<span num="10">    <b>time.Sleep(50 * time.Millisecond)</b></span>
<span num="11">    <b>c &lt;- &#34;hi there&#34;</b></span>
<span num="12"><b>}</b></span>
<span num="13"></span>
<span num="14">func main() {</span>
<span num="15">    tick := time.Tick(100 * time.Millisecond)</span>
<span num="16">    boom := time.After(300 * time.Millisecond)</span>
<span num="17">    <b>msgChannel := make(chan string)</b></span>
<span num="18">    <b>go sendMsg(msgChannel)</b></span>
<span num="19">    for {</span>
<span num="20">        select {</span>
<span num="21">        case msg := &lt;-msgChannel:</span>
<span num="22">            fmt.Printf(&#34;msg: %s\n&#34;, msg)</span>
<span num="23">        case &lt;-tick:</span>
<span num="24">            fmt.Println(&#34;tick.&#34;)</span>
<span num="25">        case &lt;-boom:</span>
<span num="26">            fmt.Println(&#34;BOOM!&#34;)</span>
<span num="27">            return</span>
<span num="28">        }</span>
<span num="29">    }</span>
<span num="30">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Unit testing</h3>
        
  <ul>
  
    <li>Part of toolchain</li>
  
    <li>In same package, dedicated file</li>
  
    <li>Filename convention: _test.go</li>
  
  </ul>

  <div class="code" contenteditable="true" spellcheck="false">


<pre><span num="4">import (</span>
<span num="5">    &#34;testing&#34;</span>
<span num="6">)</span>
<span num="7"></span>
<span num="8">// function under test defined in other source file</span>
<span num="9">func TestReverseAscii(t *testing.T) {</span>
<span num="10">    value := reverse(&#34;cram&#34;)</span>
<span num="11">    if value != &#34;marc&#34; {</span>
<span num="12">        t.Errorf(&#34;ERROR : Expecting[%s] Received[%s]&#34;, &#34;marc&#34;, value)</span>
<span num="13">    }</span>
<span num="14">}</span>
</pre>


</div>

  
  <div class="code"><pre>$ go test
FAIL: TestDoit (0.00s)
go_test.go:14: ERROR : Expecting[marc] Received[cram]</pre></div>
  

      
      </article>
  
  
  
      <article>
      
        <h3>More on testing</h3>
        
  <ul>
  
    <li>Benchmarking</li>
  
    <li>Code coverage</li>
  
    <li>Race condition detection</li>
  
    <li>Http integration testing: see &#34;httptest&#34;-package</li>
  
  </ul>
<p class="link"><a href="https://www.youtube.com/watch?v=ndmB0bj7eyw" target="_blank">More details: google-search &#34;testing techniques golang&#34;</a></p>
      
      </article>
  
  
  
      <article>
      
        <h3>Rich standard libraries</h3>
        
  
  <p>
    Just a few examples:
<br>

    - flags
<br>

    - file I/O
<br>

    - sync
<br>

    - logging
<br>

    - os
<br>

    - networking
<br>

    - http, http2: client and server
<br>

    - encoding (json, xml, mime)
<br>

    - compression
<br>

    - crypto
<br>

    - templates
<br>

    - ...
  </p>
  

      
      </article>
  
  
  
      <article>
      
        <h3>Flags</h3>
        
  <ul>
  
    <li>Read command-line argument</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import (
  &#34;flag&#34;
  &#34;fmt&#34;
  &#34;log&#34;
  &#34;os&#34;
  &#34;path&#34;
)

</span></pre>

<pre><span num="12">func printUsage() {</span>
<span num="13">    fmt.Fprintf(os.Stderr, &#34;\nUsage:\n&#34;)</span>
<span num="14">    fmt.Fprintf(os.Stderr, &#34; %s [flags]\n&#34;, path.Base(os.Args[0]))</span>
<span num="15">    <b>flag.PrintDefaults()</b></span>
<span num="16">    fmt.Fprintf(os.Stderr, &#34;\n&#34;)</span>
<span num="17">    os.Exit(1)</span>
<span num="18">}</span>
<span num="19"></span>
<span num="20">func main() {</span>
<span num="21">    <b>login := flag.String(&#34;login&#34;, &#34;&#34;, &#34;GitHub login of user&#34;)</b></span>
<span num="22">    <b>once := flag.Bool(&#34;once&#34;, false, &#34;Perform action once&#34;)</b></span>
<span num="23">    flag.Parse()</span>
<span num="24"></span>
<span num="25">    if *login == &#34;&#34; {</span>
<span num="26">        printUsage()</span>
<span num="27">    }</span>
<span num="28"></span>
<span num="29">    log.Printf(&#34;Looking up GitHub user: %s (once:%v)&#34;, login, once)</span>
<span num="30">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>HTTP server</h3>
        
  <div class="code" contenteditable="true" spellcheck="false">


<pre><span num="10">type timeHandler struct {</span>
<span num="11">    format string</span>
<span num="12">}</span>
<span num="13"></span>
<span num="14">func (th *timeHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {</span>
<span num="15">    tm := time.Now().Format(th.format)</span>
<span num="16">    fmt.Fprintf(w, &#34;The time is: &#34; &#43; tm)</span>
<span num="17">}</span>
<span num="18"></span>
<span num="19">func main() {</span>
<span num="20">    mux := http.NewServeMux()</span>
<span num="21"></span>
<span num="22">    th1123 := &amp;timeHandler{format: time.RFC1123}</span>
<span num="23">    mux.Handle(&#34;/time/rfc1123&#34;, th1123)</span>
<span num="24"></span>
<span num="25">    th3339 := &amp;timeHandler{format: time.RFC3339}</span>
<span num="26">    mux.Handle(&#34;/time/rfc3339&#34;, th3339)</span>
<span num="27"></span>
<span num="28">    http.ListenAndServe(&#34;:3000&#34;, mux)</span>
<span num="29">}</span>
</pre>


</div>

  <ul>
  
    <li>Fileserver and reverse proxy included</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Synchronisation</h3>
        
  <ul>
  
    <li>Alternative to channels</li>
  
    <li>Use for small syncs</li>
  
  </ul>

  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>package main

import (
  &#34;fmt&#34;
  &#34;strconv&#34;
  &#34;sync&#34;
)

</span></pre>

<pre><span num="11">type Currency struct {</span>
<span num="12">    <b>sync.Mutex</b></span>
<span num="13">    amount     float64</span>
<span num="14">    code       string</span>
<span num="15">}</span>
<span num="16"></span>
<span num="17">func (c *Currency) Add(i float64) {</span>
<span num="18">    <b>c.Lock()</b></span>
<span num="19">    c.amount &#43;= i</span>
<span num="20">    <b>c.Unlock()</b></span>
<span num="21">}</span>
<span num="22"></span>
<span num="23">func (c *Currency) Display() string {</span>
<span num="24">    <b>c.Lock()</b></span>
<span num="25">    <b>defer c.Unlock()</b></span>
<span num="26">    return strconv.FormatFloat(c.amount, &#39;f&#39;, 2, 64) &#43; &#34; &#34; &#43; c.code</span>
<span num="27">}</span>
</pre>

<pre style="display: none"><span>
func main() {
  c := Currency{amount: 10, code: &#34;EU&#34;}
  fmt.Printf(&#34;initial amount:%s\n&#34;, c.Display())
  c.Add(-7.54)
  fmt.Printf(&#34;amount after payment:%s\n&#34;, c.Display())
}
</span></pre>
</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Encoding</h3>
        
  <div class="code playground" contenteditable="true" spellcheck="false">
<pre style="display: none"><span>// hello.go
package main

import (
  &#34;encoding/json&#34;
  &#34;encoding/xml&#34;
  &#34;fmt&#34;
)

type Person struct {
  Name      string
  Interests []string
  Children  []Child
}

type Child struct {
  Name string
  Age  int
}

</span></pre>

<pre><span num="21">func main() {</span>
<span num="22">    var jsonMe string = `</span>
<span num="23">    {</span>
<span num="24">        &#34;Name&#34;:&#34;Marc Grol&#34;,</span>
<span num="25">        &#34;Interests&#34;:[&#34;Running&#34;,&#34;Golang&#34;],</span>
<span num="26">        &#34;Children&#34;:[</span>
<span num="27">            {&#34;Name&#34;:&#34;Pien&#34;,&#34;Age&#34;:12},</span>
<span num="28">            {&#34;Name&#34;:&#34;Tijl&#34;,&#34;Age&#34;:9},</span>
<span num="29">            {&#34;Name&#34;:&#34;Freek&#34;,&#34;Age&#34;:5}</span>
<span num="30">        ]</span>
<span num="31">    }`</span>
<span num="32"></span>
<span num="33">    var me Person</span>
<span num="34">    <b>json.Unmarshal([]byte(jsonMe), &amp;me)</b></span>
<span num="35"></span>
<span num="36">    fmt.Printf(&#34;About me (internal):\n %&#43;v\n&#34;, me)</span>
<span num="37"></span>
<span num="38">    <b>xmlMe, _ := xml.Marshal(me)</b></span>
<span num="39">    fmt.Printf(&#34;About me (xml):\n %s\n&#34;, xmlMe)</span>
<span num="40">}</span>
</pre>


</div>

      
      </article>
  
  
  
      <article>
      
        <h3>Templating</h3>
        
  <ul>
  
    <li>web-server: generate html response using template</li>
  
    <li>code generation: generate text-files on file-system</li>
  
  </ul>
<p class="link"><a href="https://github.com/MarcGrol/microgen/blob/master/application.go" target="_blank">model</a></p><p class="link"><a href="https://github.com/MarcGrol/microgen/blob/master/tool/dsl/service-interface.go.tmpl" target="_blank">template</a></p>
      
      </article>
  
  
  
      <article>
      
        <h3>&#34;Kind of&#34; generics</h3>
        
  <ul>
  
    <li>go get github.com/clipperhouse/gen</li>
  
  </ul>

  <div class="code" contenteditable="true" spellcheck="false">


<pre><span num="1">package tour</span>
<span num="2"></span>
<span num="3">//go:generate gen</span>
<span num="4"></span>
<span num="5">// &#43;gen slice:&#34;SortBy,Where&#34;</span>
<span num="6">type Cyclist struct {</span>
<span num="7">    Number int    `json:&#34;number&#34;`</span>
<span num="8">    Name   string `json:&#34;name&#34;`</span>
<span num="9">    Team   string `json:&#34;team&#34;`</span>
<span num="10">}</span>
</pre>


</div>

  
  <div class="code"><pre>$ go generate ./...
generates cyclist_slice.go with &#34;SortBy&#34;- and &#34;Where&#34;-methods on CyclistSlice</pre></div>
  

  <ul>
  
    <li>Just commit and distribute with your package</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Complete tool-chain</h3>
        
  
  <div class="code"><pre>$ go list ./...                  # list sub-packages
$ go list -f {{.Deps}}           # list external deps

# no flame-wars, easy to diff, allow mechanical manipulation
$ go fmt ./...                   # format recursively

# Be effective within seconds
$ go get github.com/bitly/go-nsq # fetch external package

# testing: tooling supports coverage, benchmark, race-condition-detection
$ go test ./...                  # test recursively 

# compile
$ go build or go run             # add hoc
$ go install                     # to ${GOPATH}/bin

$ godoc -http=:8000              # documentation of sources in ${GOROOT} and ${GOPATH}
$ go vet                         # lint like</pre></div>
  

  <ul>
  
    <li>All CLI -&gt; Easy to automate</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Simple build system</h3>
        
  <ul>
  
    <li>Based on filesystem and conventions</li>
  
    <li>No Makefiles, autotools, build.xml, pom.xml etc</li>
  
    <li>The tool knows how to build</li>
  
    <li>Easy to integrate 3rd packages: only integrate source-code</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>Easy deployment</h3>
        
  <ul>
  
    <li>Single, self contained binary</li>
  
    <li>No runtime</li>
  
    <li>Just scp to target host</li>
  
    <li>go 1.5 supports cross compilation</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>The not so good</h3>
        
  <ul>
  
    <li>Reproducable builds: versioning of 3rd party dependencies</li>
  
    <li>IDE support: vi, sublime, eclipse, intelliJ</li>
  
    <li>No immutability by default</li>
  
    <li>Missing generics?</li>
  
  </ul>

      
      </article>
  
  
  
      <article>
      
        <h3>So why go?</h3>
        
  <ul>
  
    <li>Simple, readable language</li>
  
    <li>Rich standard libraries</li>
  
    <li>Complete tool-chain</li>
  
    <li>Good at concurrency</li>
  
    <li>Fast</li>
  
    <li>Easy to build and deploy</li>
  
    <li>Used by many startups</li>
  
  </ul>

  <ul>
  
    <li>Language to get things done</li>
  
  </ul>
<p class="link"><a href="https://golang.org/" target="_blank">golang.org/</a></p>
      
      </article>
  
  
  
      <article>
      
        <h3>Go do it</h3>
        
  <ul>
  
    <li>Start experimenting</li>
  
  </ul>

<div class="image">
  <img src="images/gophereartrumpet.jpg">
</div>
<figcaption>Go is cool:  Tell it around</figcaption>
  <ul>
  
    <li>Let&#39;s build something</li>
  
  </ul>

      
      </article>
  
  

      <article>
        <h3>Thank you</h3>
        
          <div class="presenter">
            
  
  <p>
    Marc Grol
  </p>
  

  
  <p>
    Software engineer, Xebia
  </p>
  
<p class="link"><a href="mailto:mgrol@xebia.com" target="_blank">mgrol@xebia.com</a></p><p class="link"><a href="http://www.xebia.com/" target="_blank">http://www.xebia.com/</a></p><p class="link"><a href="https://github.com/MarcGrol/" target="_blank">https://github.com/MarcGrol/</a></p>
          </div>
        
          <div class="presenter">
            
  
  <p>
    
  </p>
  

          </div>
        
      </article>

    </section>

    <div id="help">
      Use the left and right arrow keys or click the left and right
      edges of the page to navigate between slides.<br>
      (Press 'H' or navigate to hide this message.)
    </div>

  </body>
  
  <script src='/play.js'></script>
  
</html>
